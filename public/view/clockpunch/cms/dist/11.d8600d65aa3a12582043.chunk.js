webpackJsonp([11],{655:function(e,s,t){t(737);var o=t(34)(t(696),t(777),null,null);o.options.__file="C:\\Users\\29423\\Documents\\progress\\zaoqidaka\\CMS\\iview-admin\\src\\views\\own-space\\own-space.vue",o.esModule&&Object.keys(o.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),o.options.functional&&console.error("[vue-loader] own-space.vue: functional components are not supported with templates, they should use render functions."),e.exports=o.exports},696:function(e,s,t){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(s,"__esModule",{value:!0});var a=t(71),r=o(a),n=t(43),i=o(n),d=t(55),l=o(d);s.default={name:"own-space",data:function(){var e=this;return{userForm:{name:"",cellphone:"",company:"",department:""},uid:"",securityCode:"",phoneHasChanged:!1,save_loading:!1,identifyError:"",editPasswordModal:!1,savePassLoading:!1,oldPassError:"",identifyCodeRight:!1,hasGetIdentifyCode:!1,canGetIdentifyCode:!1,checkIdentifyCodeLoading:!1,inforValidate:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],cellphone:[{required:!0,message:"请输入手机号码"},{validator:function(e,s,t){/^1[0-9]{10}$/.test(s)?t():t(new Error("请输入正确格式的手机号"))}}]},editPasswordForm:{oldPass:"",newPass:"",rePass:""},passwordValidate:{oldPass:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPass:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"请至少输入6个字符",trigger:"blur"},{max:32,message:"最多输入32个字符",trigger:"blur"}],rePass:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:function(s,t,o){t!==e.editPasswordForm.newPass?o(new Error("两次输入密码不一致")):o()},trigger:"blur"}]},inputCodeVisible:!1,initPhone:"",gettingIdentifyCodeBtnContent:"获取验证码"}},methods:{getIdentifyCode:function(){var e=this;this.hasGetIdentifyCode=!0,this.$refs.userForm.validate(function(s){if(s){e.canGetIdentifyCode=!0;var t=60,o=setInterval(function(){t>=0?(e.gettingIdentifyCodeBtnContent=t+"秒后重试",t-=1):(clearInterval(o),e.gettingIdentifyCodeBtnContent="获取验证码",e.canGetIdentifyCode=!1)},1e3);e.inputCodeVisible=!0}})},showEditPassword:function(){this.editPasswordModal=!0},cancelEditUserInfor:function(){this.$store.commit("removeTag","ownspace_index"),localStorage.pageOpenedList=(0,r.default)(this.$store.state.pageOpenedList);var e="";e=this.$store.state.pageOpenedList.length>1?this.$store.state.pageOpenedList[1].name:this.$store.state.pageOpenedList[0].name,this.$router.push({name:e})},saveEdit:function(){var e=this;console.log("保存"),this.$refs.userForm.validate(function(s){s&&(e.phoneHasChanged&&e.userForm.cellphone!==e.initPhone?e.hasGetIdentifyCode?e.identifyCodeRight?e.saveInfoAjax():e.$Message.error("验证码错误，请重新输入"):e.$Message.warning("请先点击获取验证码"):e.saveInfoAjax())})},cancelEditPass:function(){this.editPasswordModal=!1},saveEditPass:function(){var e=this,s=this;this.$refs.editPasswordForm.validate(function(t){if(t){e.savePassLoading=!0,e.savePassLoading=!1,console.log(e.editPasswordForm);var o=(i.default.get("password"),i.default.get("user")),a={user:o,password:s.editPasswordForm.oldPass,newPassword:s.editPasswordForm.rePass};l.default.ajax.post("/api/clockPunch/cms/changePassword",a).then(function(t){i.default.set("password",s.editPasswordForm.rePass),e.$Message.success({content:"修改成功！",duration:2,closable:!1,onClose:function(){s.editPasswordForm.oldPass="",s.editPasswordForm.newPass="",s.editPasswordForm.rePass="",s.cancelEditPass()}}),e.savePassLoading=!1}).catch(function(t){e.savePassLoading=!1,s.$Message.warning("原密码错误！")})}})},init:function(){var e=i.default.get("user");console.log(e),this.userForm.name=e,this.userForm.cellphone="17712345678",this.initPhone="17712345678",this.userForm.company="TalkingData",this.userForm.department="可视化部门"},cancelInputCodeBox:function(){this.inputCodeVisible=!1,this.userForm.cellphone=this.initPhone},submitCode:function(){var e=this;this.checkIdentifyCodeLoading=!0,0===this.securityCode.length?this.$Message.error("请填写短信验证码"):setTimeout(function(){e.$Message.success("验证码正确"),e.inputCodeVisible=!1,e.checkIdentifyCodeLoading=!1},1e3)},hasChangePhone:function(){this.phoneHasChanged=!0,this.hasGetIdentifyCode=!1,this.identifyCodeRight=!1},saveInfoAjax:function(){var e=this,s=this;this.save_loading=!0;var t=i.default.get("password"),o=i.default.get("user"),a={user:o,password:t,newUser:s.userForm.name};l.default.ajax.post("/api/clockPunch/cms/changeName",a).then(function(t){i.default.set("user",s.userForm.name),e.$Message.success("保存成功"),e.save_loading=!1}).catch(function(t){e.save_loading=!1,s.$Message.warning("修改失败！")})}},mounted:function(){this.init()}}},737:function(e,s){},777:function(e,s,t){e.exports={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("Card",[t("p",{attrs:{slot:"title"},slot:"title"},[t("Icon",{attrs:{type:"person"}}),e._v("\n            个人信息\n        ")],1),e._v(" "),t("div",[t("Form",{ref:"userForm",attrs:{model:e.userForm,"label-width":100,"label-position":"right",rules:e.inforValidate}},[t("FormItem",{attrs:{label:"用户姓名：",prop:"name"}},[t("div",{staticStyle:{display:"inline-block",width:"300px"}},[t("Input",{model:{value:e.userForm.name,callback:function(s){e.$set(e.userForm,"name",s)},expression:"userForm.name"}})],1)]),e._v(" "),t("FormItem",{attrs:{label:"登录密码："}},[t("Button",{attrs:{type:"text",size:"small"},on:{click:e.showEditPassword}},[e._v("修改密码")])],1),e._v(" "),t("div",[t("Button",{staticStyle:{width:"100px"},attrs:{type:"text"},on:{click:e.cancelEditUserInfor}},[e._v("取消")]),e._v(" "),t("Button",{staticStyle:{width:"100px"},attrs:{type:"primary",loading:e.save_loading},on:{click:e.saveEdit}},[e._v("保存")])],1)],1)],1)]),e._v(" "),t("Modal",{attrs:{closable:!1,"mask-closable":!1,width:500},model:{value:e.editPasswordModal,callback:function(s){e.editPasswordModal=s},expression:"editPasswordModal"}},[t("h3",{staticStyle:{color:"#2D8CF0"},attrs:{slot:"header"},slot:"header"},[e._v("修改密码")]),e._v(" "),t("Form",{ref:"editPasswordForm",attrs:{model:e.editPasswordForm,"label-width":100,"label-position":"right",rules:e.passwordValidate}},[t("FormItem",{attrs:{label:"原密码",prop:"oldPass",error:e.oldPassError}},[t("Input",{attrs:{placeholder:"请输入现在使用的密码"},model:{value:e.editPasswordForm.oldPass,callback:function(s){e.$set(e.editPasswordForm,"oldPass",s)},expression:"editPasswordForm.oldPass"}})],1),e._v(" "),t("FormItem",{attrs:{label:"新密码",prop:"newPass"}},[t("Input",{attrs:{placeholder:"请输入新密码，至少6位字符"},model:{value:e.editPasswordForm.newPass,callback:function(s){e.$set(e.editPasswordForm,"newPass",s)},expression:"editPasswordForm.newPass"}})],1),e._v(" "),t("FormItem",{attrs:{label:"确认新密码",prop:"rePass"}},[t("Input",{attrs:{placeholder:"请再次输入新密码"},model:{value:e.editPasswordForm.rePass,callback:function(s){e.$set(e.editPasswordForm,"rePass",s)},expression:"editPasswordForm.rePass"}})],1)],1),e._v(" "),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("Button",{attrs:{type:"text"},on:{click:e.cancelEditPass}},[e._v("取消")]),e._v(" "),t("Button",{attrs:{type:"primary",loading:e.savePassLoading},on:{click:e.saveEditPass}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]},e.exports.render._withStripped=!0}});